function fetchResponse(e){e.token?(msgDiv.innerHTML="Login correcto. <br><br> Token: "+e.token,localStorage.setItem("token",e.token)):e.message?msgDiv.innerHTML=e.message:e.length>=0?e.forEach(e=>{msgDiv.innerHTML+=`\n      id: ${e.id} <br> \n      username: ${e.username} <br> \n      created At: ${dateFormat(e.createdAt)} <br> \n      updated At: ${dateFormat(e.updatedAt)} <br><br>\n    `}):msgDiv.innerHTML=`\n      id: ${e.id} <br> \n      username: ${e.username} <br> \n      created At: ${dateFormat(e.createdAt)} <br> \n      updated At: ${dateFormat(e.updatedAt)} \n    `}function resetForm(){form.reset(),form.className="",msgDiv.innerHTML="",inputs.forEach(e=>{e.classList.remove("borderValidation"),e.classList.remove("d-none")})}function validateForm(e){let t=!0;return"get"===e?t:(inputs.forEach(e=>{0===e.value.length?(e.classList.add("borderValidation"),t=!1):e.classList.remove("borderValidation")}),t)}function dateFormat(e){let t,r,o;return e=new Date(e),t=e.getDate(),r=e.getMonth()+1,o=e.getFullYear(),t=t.toString().padStart(2,"0"),r=r.toString().padStart(2,"0"),`${t}/${r}/${o}`}const lis=document.querySelectorAll("li"),form=document.querySelector("form"),formTitle=document.querySelector(".formTitle"),inputs=document.querySelectorAll("input"),msgDiv=document.querySelector("form div");lis.forEach(e=>{e.addEventListener("click",e=>{switch(form.classList.remove("d-none"),resetForm(),e.target.id){case"1":formTitle.innerHTML="Registro",form.classList.add("register"),form.setAttribute("fetchMethod","post");break;case"2":formTitle.innerHTML="Login",form.classList.add("authenticate"),form.setAttribute("fetchMethod","post");break;case"3":formTitle.innerHTML="Ver mi usuario",inputs[0].classList.add("d-none"),inputs[1].classList.add("d-none"),form.classList.add("current"),form.setAttribute("fetchMethod","get");break;case"4":formTitle.innerHTML="Ver todos los usuarios",inputs[0].classList.add("d-none"),inputs[1].classList.add("d-none"),form.className="",form.setAttribute("fetchMethod","get")}})}),form.addEventListener("submit",e=>{e.preventDefault();const t=form.getAttribute("fetchMethod");if(validateForm(t)){const r=e.target.className;let o={};switch(t){case"post":o={method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:inputs[0].value,password:inputs[1].value})};break;case"get":const e=localStorage.getItem("token");o={method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}}fetch("http://127.0.0.1:3000/users/"+r,o).then(e=>e.json()).then(e=>{fetchResponse(e)}).catch(e=>{msgDiv.innerHTML="Ha ocurrido un error en la API. "+e})}});